# ML_HW1  

Ссылка на стримлит - https://baranov-ml1-2.streamlit.app/

## Что было сделано  
Если кратко - всё.  
Если не кратко:
### EDA и визуализация 
- Датасет почищен от пропусков и дубликатов  
- Все столбцы приведены к удобным типам данных
- Данные визуализированы самыми различными способами
### Модель только на вещественных признаках  
- Создана универсальная функция stats, которая считает все необходимые статистики для моделей
- Обучены модели без скейлера: LinearRegression
- Со скейлером StandardScaler: LinearRegression, Lasso с alpha=1, Lasso с alpha=0.1,
- Со скейлером и подбором гиперпараметров GridSearchCV: Lasso с alpha=0.05, ElasticNet с alpha=0.13 и f1=0.1
### Добавляем категориальные фичи  
- Не удалил, а превратил колонку name в категориальбную brand с 32 категориями и сделал OHE для всех категориальных столбцов
- Со скейлером и подбором гиперпараметров GridSearchCV обучил: Ridge с alpha=547
###  Бизнесовая часть
- Реализовал бизнес метрику и посчитал для всех обученных моделей и выяснил, что лучше всего работает наша последняя модель - гребневая регрессия (Ridge) со значением 0.316
### Репозиторий и Streamlit app  
- Оформил репозиторий по требованиям
- Реализовал приложение на streamlit и задеплоил в Streamlit Community Cloud - https://baranov-ml1-2.streamlit.app/
## Метрики  
### Модели без скейлера:
___Train___  
model: LinearRegression  
R^2: 0.5922629595849875  
MSE: 116873067751.52162  
RMSE: 341867.0322676956  
business metric: 0.21472602739726027  
___Test___  
model: LinearRegression  
R^2: 0.5941441219017134  
MSE: 233297548204.61063  
RMSE: 483008.84899203514  
business metric: 0.227  

### Со скейлером StandardScaler:
___Train___  
model: LinearRegression  
R^2: 0.5922629595849875  
MSE: 116873067751.52162  
RMSE: 341867.0322676956  
business metric: 0.21472602739726027  
___Test___  
model: LinearRegression  
R^2: 0.594144121901726  
MSE: 233297548204.6034  
RMSE: 483008.8489920277  
business metric: 0.227  

___Train___  
model: Lasso alpha=1  
R^2: 0.0  
MSE: 286638338357.88654  
RMSE: 535386.1581679961  
business metric: 0.11746575342465754  
___Test___  
model: Lasso alpha=1  
R^2: -0.01568082182097763  
MSE: 583842339797.0208  
RMSE: 764095.7661164082  
business metric: 0.11  

___Train___  
model: Lasso alpha=0.1  
R^2: 0.5667815057372207  
MSE: 124177029341.38866  
RMSE: 352387.61235518573  
business metric: 0.2095890410958904  
___Test___  
model: Lasso alpha=0.1  
R^2: 0.5340007735794066  
MSE: 267869662251.9821  
RMSE: 517561.2642499263  
business metric: 0.235  

### Со скейлером и подбором гиперпараметров GridSearchCV:
___Train___  
model: Lasso alpha=0.05  
R^2: 0.5826848011150403  
MSE: 119618535179.87581  
RMSE: 345859.1262058525  
business metric: 0.20633561643835616  
___Test___  
model: Lasso alpha=0.05  
R^2: 0.564756023641142  
MSE: 250190666280.69556  
RMSE: 500190.6299409212  
business metric: 0.233  

___Train___  
model: ElasticNet alpha=0.13 f1=0.1  
R^2: 0.584266681966813  
MSE: 119165107481.04352  
RMSE: 345202.99460034166  
business metric: 0.2202054794520548  
___Test___  
model: ElasticNet alpha=0.13 f1=0.1  
R^2: 0.5598357856423902  
MSE: 253018959582.91544  
RMSE: 503009.9000843974  
business metric: 0.249  

### С категориальными фичами:
___Train___  
model: Ridge alpha=547  
R^2: 0.7703255182627051  
MSE: 65833511808.38696  
RMSE: 256580.41976812447  
business metric: 0.2738013698630137  
___Test___  
model: Ridge alpha=547  
R^2: 0.7804671967054135  
MSE: 126193724233.08588  
RMSE: 355237.56027915445  
business metric: 0.316

## Интерпритация метрик  
Абсолютно все модели работают ужасно, самая низкая RMSE на тесте - 355237 рублей, что больше половины от средней цены, никуда не годится  
Лучший R2 - 0.78, неплохо, хотя очень далеко от идеала, качество такой модели можно оценить как средненкое.
Хотя чем больше мы делали улучшений, тем точнее становились прогнозы.

## Прирост качества  
Добавление категориальных фичей и переход к Ridge регрессии дало наиболее сильный прирост качества. От RMSE на тесте порядка 500к перешли к порядку 350к, что много  

## Неудачи  
Ну удалось полностью обработать потенциально полезную категориальную колонку name, удалось вытащить только марку машины.  
